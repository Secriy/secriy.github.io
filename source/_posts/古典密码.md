---
title: 古典密码
categories: 学习笔记
tags: 密码学
date: 2020-10-08 01:27:40
mathjax: true
---

{% noteblock quote cyan %}

密码学之古典密码。

{% endnoteblock %}

<!-- more -->

## 分类

古典密码一般分为置换和代换两种方式。

- 置换密码
  - 列置换
  - 周期置换
- 代换密码
  - 单表代换
  - 夺标代换

## 置换密码

置换密码（Permutation Cipher），又称换位密码（Transposition Cipher），是指根据一定的规则重新排列明文，以便打破明文的结构特性。

常见的置换密码如**栅栏密码**。

![](古典密码/clip_image001.png)

如上图所示的置换，其逆置换为：

![img](古典密码/clip_image001-1605010295709.png)

### 列置换密码

#### 加密

1. 将明文 p 按固定分组宽度 m 按行写出，即每行有 m 个字符，若明文长度不足，不足部分按规定方式填充，得到明文字符矩阵。
2. 将明文字符矩阵按置换密钥交换列次序，得到密文字符矩阵。
3. 将密文字符矩阵还原为字符串，即密文 c。

#### 解密

1. 同理，将密文转换为密文字符矩阵。
2. 将密文字符矩阵按置换密钥的**逆置换**交换列次序，得到明文字符矩阵。
3. 还原明文字符矩阵为字符串，即明文 p。

### 周期置换密码

#### 加密

（设明文为 p，密钥为 k，密钥长度为 m，密文为 c）

1. 将 p 按长度 m 分组，得到多个同等长度的分组。
2. 对每个分组都使用密钥置换加密，改变分组内字符顺序。
3. 拼接各个分组，得到密文 c。

#### 解密

同加密过程，将密文转换为明文，使用的密钥为 k 的**逆置换**。

## 代换密码

代换密码（Substitution Cipher）是将明文中的字符替换为其他字符的密码体制。

置换密码本质上就是改变字符顺序来实现加密，而代换密码是使用**代换表**将明文中的字符一一代换为其他字符，从而实现加密。

代换密码一般分为**单表代换**和**多表代换**，其区别是单表代换将明文中同一字符都代换为相应的另一字符；而多表代换将一系列代换表依次对明文消息的字符序列进行代换，因此同一字符可能会被代换为不同字符。

### 单表代换密码

#### 基于密钥的单表代换密码

基于密钥的单表代换密码主要通过密钥的对应关系加密，比如将 A 映射为 C、C 映射为 F，根据代换表的代换关系得到密文。

这种方式的加密，其密钥空间为 n!（n 为明文字符**范围**的长度）。

#### 仿射密码

> The affine cipher is a type of monoalphabetic substitution cipher, where each letter in an alphabet is mapped to its numeric equivalent, encrypted using a simple mathematical function, and converted back to a letter.
>
> ——Wikipedia

**仿射密码**是一种单表代换密码，它将每个字母对应到等效的数字，然后使用简单的数学函数进行加密，最终转换回字母。

##### 加密

加密函数：

$E(x)=ax+b\pmod m$ （$a,b∈Z_{26}$）

- a 和 m 互质

- m 为字母表大小

加密过程：

1. 将字母转换为对应的数字，如 A=0，B=1...
2. 将这些数字通过加密函数计算出结果
3. 将结果按照原字母-数字转换方式转换为字母

##### 解密

由于 a 在$Z_{26}$上存在乘法逆元$a^{-1}$，能求得原加密函数的逆变换，解密函数为$a\equiv d(e(x))\equiv a^{-1}(e(x)-b)\pmod {26}$。

##### TODO:示例

加密：

|       明文       |  C  |  O  |  D  |  E  |
| :--------------: | :-: | :-: | :-: | :-: |
|        x         |  2  | 14  |  3  |  4  |
| $ax+b\pmod {26}$ |     |     |     |     |
|                  |     |     |     |     |

### 多表代换密码

常见的多表代换密码有 Playfair 密码、**Vigenère 密码**和 Hill 密码。

#### Playfair 密码

#### Vigenère 密码

#### Hill 密码

## 古典密码的分析
